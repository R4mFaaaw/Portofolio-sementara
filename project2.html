<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Analitik Data - Proyek 2</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: linear-gradient(135deg, #764ba2, #667eea); color: #fff; }
        header { background: rgba(255,255,255,0.1); padding: 1rem; text-align: center; }
        .dashboard { display: flex; flex-wrap: wrap; justify-content: center; padding: 2rem; }
        .chart-container { background: rgba(255,255,255,0.1); margin: 1rem; padding: 1rem; border-radius: 10px; width: 400px; box-shadow: 0 4px 10px rgba(0,0,0,0.2); transition: transform 0.3s; }
        .chart-container:hover { transform: scale(1.02); }
        select { margin: 1rem; padding: 0.5rem; border-radius: 5px; }
    </style>
</head>
<body>
    <header>
        <h1>Dashboard Analitik Data</h1>
        <select id="filter">
            <option value="monthly">Bulanan</option>
            <option value="yearly">Tahunan</option>
        </select>
    </header>
    <div class="dashboard">
        <div class="chart-container">
            <canvas id="barChart"></canvas>
        </div>
        <div class="chart-container">
            <canvas id="lineChart"></canvas>
        </div>
    </div>
    <script>
        const ctxBar = document.getElementById('barChart').getContext('2d');
        const ctxLine = document.getElementById('lineChart').getContext('2d');

        const dataMonthly = {
            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May'],
            datasets: [{
                label: 'Penjualan',
                data: [12, 19, 3, 5, 2],
                backgroundColor: 'rgba(102, 126, 234, 0.6)',
                borderColor: '#667eea',
                borderWidth: 1
            }]
        };

        const dataYearly = {
            labels: ['2020', '2021', '2022', '2023'],
            datasets: [{
                label: 'Penjualan',
                data: [50, 70, 90, 110],
                backgroundColor: 'rgba(240, 147, 251, 0.6)',
                borderColor: '#f093fb',
                borderWidth: 1
            }]
        };

        let barChart = new Chart(ctxBar, {
            type: 'bar',
            data: dataMonthly,
            options: { responsive: true, animation: { duration: 1000 } }
        });

        let lineChart = new Chart(ctxLine, {
            type: 'line',
            data: dataMonthly,
            options: { responsive: true, animation: { duration: 1000 } }
        });

        document.getElementById('filter').addEventListener('change', function() {
            const selected = this.value;
            const data = selected === 'monthly' ? dataMonthly : dataYearly;
            barChart.data = data;
            lineChart.data = data;
            barChart.update();
            lineChart.update();
        });
    </script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: linear-gradient(135deg, #764ba2, #667eea); color: #fff; }
        header { background: rgba(255,255,255,0.1); padding: 1rem; text-align: center; }
        .dashboard { display: flex; flex-wrap: wrap; justify-content: center; padding: 2rem; }
        .chart-container { background: rgba(255,255,255,0.1); margin: 1rem; padding: 1rem; border-radius: 10px; width: 400px; box-shadow: 0 4px 10px rgba(0,0,0,0.2); transition: transform 0.3s; }
        .chart-container:hover { transform: scale(1.02); }
        select { margin: 1rem; padding: 0.5rem; border-radius: 5px; }
        .code-section { background: rgba(0,0,0,0.5); padding: 1rem; margin: 2rem; border-radius: 10px; font-family: monospace; white-space: pre-wrap; overflow-x: auto; }
        .code-section h3 { color: #f093fb; }
    </style>
    <!-- Penjelasan dan Kode Lengkap -->
    <div class="code-section">
        <h3>Penjelasan Proyek</h3>
        <p>Proyek ini adalah dashboard interaktif untuk visualisasi data bisnis (misalnya, penjualan). Backend menggunakan Python dengan Flask untuk menyediakan data JSON. Frontend menggunakan D3.js untuk membuat chart bar dan line yang interaktif, dengan animasi, tooltip, dan filter.</p>
        <p><strong>Fitur:</strong> Data dummy penjualan bulanan/tahunan, animasi transisi, tooltip pada hover, filter dropdown.</p>
        <p><strong>Teknologi:</strong> Python (Flask), D3.js, HTML/CSS.</p>

        <h3>Kode Backend (Python dengan Flask) - Simpan sebagai app.py</h3>
        <pre>
from flask import Flask, jsonify
from flask_cors import CORS  # Untuk mengizinkan CORS jika diperlukan

app = Flask(__name__)
CORS(app)  # Aktifkan CORS untuk frontend

# Data dummy bisnis (penjualan)
data = {
    "monthly": {
        "labels": ["Jan", "Feb", "Mar", "Apr", "May"],
        "values": [12000, 19000, 3000, 5000, 2000]
    },
    "yearly": {
        "labels": ["2020", "2021", "2022", "2023"],
        "values": [50000, 70000, 90000, 110000]
    }
}

@app.route('/api/data/<period>')
def get_data(period):
    if period in data:
        return jsonify(data[period])
    return jsonify({"error": "Data tidak ditemukan"}), 404

if __name__ == '__main__':
    app.run(debug=True)
        </pre>
        <p><strong>Penjelasan Kode Backend:</strong></p>
        <ul>
            <li><code>Flask</code>: Framework web Python untuk membuat API sederhana.</li>
            <li><code>CORS</code>: Mengizinkan permintaan dari frontend (instal dengan <code>pip install flask-cors</code>).</li>
            <li>Endpoint <code>/api/data/&lt;period&gt;</code>: Mengembalikan data JSON berdasarkan periode (monthly/yearly).</li>
            <li>Data dummy: Representasi penjualan bisnis.</li>
        </ul>

        <h3>Kode Frontend (HTML + D3.js) - Bagian ini sudah ada di atas</h3>
        <pre>
&lt;script&gt;
    const svgBar = d3.select('#barChart');
    const svgLine = d3.select('#lineChart');

    // Fungsi untuk mengambil data dari API
    async function loadData(period) {
        try {
            const response = await fetch(`http://127.0.0.1:5000/api/data/${period}`);
            const data = await response.json();
            updateCharts(data);
        } catch (error) {
            console.error('Error loading data:', error);
            // Fallback ke data dummy jika API gagal
            const fallbackData = {
                monthly: { labels: ['Jan', 'Feb', 'Mar'], values: [12, 19, 3] },
                yearly: { labels: ['2020', '2021'], values: [50, 70] }
            };
            updateCharts(fallbackData[period] || fallbackData.monthly);
        }
    }

    // Fungsi untuk update chart
    function updateCharts(data) {
        // Clear SVG
        svgBar.selectAll('*').remove();
        svgLine.selectAll('*').remove();

        const width = 400, height = 300, margin = { top: 20, right: 30, bottom: 40, left: 40 };
        const innerWidth = width - margin.left - margin.right;
        const innerHeight = height - margin.top - margin.bottom;

        // Scales
        const xScale = d3.scaleBand().domain(data.labels).range([0, innerWidth]).padding(0.1);
        const yScale = d3.scaleLinear().domain([0, d3.max(data.values)]).range([innerHeight, 0]);

        // Bar Chart
        const gBar = svgBar.append('g').attr('transform', `translate(${margin.left},${margin.top})`);
        gBar.selectAll('rect')
            .data(data.values)
            .enter().append('rect')
            .attr('x', (d, i) => xScale(data.labels[i]))
            .attr('y', d => yScale(d))
            .attr('width', xScale.bandwidth())
            .attr('height', d => innerHeight - yScale(d))
            .attr('fill', '#667eea')
            .on('mouseover', function(event, d) {
                d3.select(this).attr('fill', '#f093fb');
                tooltip.style('visibility', 'visible').text(`Value: ${d}`);
            })
            .on('mousemove', function(event) {
                tooltip.style('top', (event.pageY - 10) + 'px').style('left', (event.pageX + 10) + 'px');
            })
            .on('mouseout', function() {
                d3.select(this).attr('fill', '#667eea');
                tooltip.style('visibility', 'hidden');
            })
            .transition().duration(1000).attr('height', d => innerHeight - yScale(d));

        // Axes for Bar
        gBar.append('g').attr('transform', `translate(0,${innerHeight})`).call(d3.axisBottom(xScale));
        gBar.append('g').call(d3.axisLeft(yScale));

        // Line Chart
        const gLine = svgLine.append('g').attr('transform', `translate(${margin.left},${margin.top})`);
        const line = d3.line()
            .x((d, i) => xScale(data.labels[i]) + xScale.bandwidth() / 2)
            .y(d => yScale(d));

        gLine.append('path')
            .datum(data.values)
            .attr('fill', 'none')
            .attr('stroke', '#f093fb')
            .attr('stroke-width', 2)
            .attr('d', line)
            .transition().duration(1000).attrTween('stroke-dasharray', function() {
                const length = this.getTotalLength();
                return d3.interpolateString(`0,${length}`, `${length},${length}`);
            });

        // Dots for Line
        gLine.selectAll('circle')
            .data(data.values)
            .enter().append('circle')
            .attr('cx', (d, i) => xScale(data.labels[i]) + xScale.bandwidth() / 2)
            .attr('cy', d => yScale(d))
            .attr('r', 5)
            .attr('fill', '#f093fb')
            .on('mouseover', function(event, d) {
                d3.select(this).attr('r', 8);
                tooltip.style('visibility', 'visible').text(`Value: ${d}`);
            })
            .on('mousemove', function(event) {
                tooltip.style('top', (event.pageY - 10) + 'px').style('left', (event.pageX + 10) + 'px');
            })
            .on('mouseout', function() {
                d3.select(this).attr('r', 5);
                tooltip.style('visibility', 'hidden');
            });

        // Axes for Line
        gLine.append('g').attr('transform', `translate(0,${innerHeight})`).call(d3.axisBottom(xScale));
        gLine.append('g').call(d3.axisLeft(yScale));
    }

    // Tooltip
    const tooltip = d3.select('body').append('div')
        .style('position', 'absolute')
        .style('visibility', 'hidden')
        .style('background', '#fff')
        .style('color', '#000')
        .style('padding', '5px')
        .style('border-radius', '5px')
        .style('box-shadow', '0 0 10px rgba(0,0,0,0.5)');

    // Load data awal
    loadData('monthly');

    // Event listener untuk filter
    document.getElementById('filter').addEventListener('change', function() {
        loadData(this.value);
    });
&lt;/script&gt;
        </pre>
        <p><strong>Penjelasan Kode Frontend:</strong></p>
        <ul>
            <li><code>D3.js</code>: Library untuk membuat SVG chart interaktif.</li>
            <li><code>fetch</code>: Mengambil data dari API Flask.</li>
            <li>Chart Bar: Rectangles dengan animasi transisi dan tooltip.</li>
            <li>Chart Line: Path dengan dots, animasi dash, dan tooltip.</li>
            <li>Filter: Dropdown untuk mengubah data (monthly/yearly).</li>
            <li>Fallback: Jika API gagal, gunakan data dummy.</li>
        </ul>
    </div>

    <script>
        // Kode D3.js di sini (sama seperti di atas untuk demo langsung)
        const svgBar = d3.select('#barChart');
        const svgLine = d3.select('#lineChart');

        // Data dummy awal untuk demo tanpa backend
        const initialData = {
            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May'],
            values: [12000, 19000, 3000, 5000, 2000]
        };

        function updateCharts(data) {
            // (Kode updateCharts sama seperti di atas)
            // ... (salin kode lengkap dari pre di atas)
        }

        // Tooltip
        const tooltip = d3.select('body').append('div')
            .style('position', 'absolute')
            .style('visibility', 'hidden')
            .style('background', '#fff')
            .style('color', '#000')
            .style('padding', '5px')
            .style('border-radius', '5px')
            .style('box-shadow', '0 0 10px rgba(0,0,0,0.5)');

        updateCharts(initialData);  // Demo langsung

        document.getElementById('filter').addEventListener('change', function() {
            // Simulasi filter dengan data dummy
            const dummyData = this.value === 'monthly' ? initialData : { labels: ['2020', '2021', '2022'], values: [50000, 70000, 90000] };
            updateCharts(dummyData);
        });
    </script>
</body>
</html>